# Generic Policy Decorator Generator

A C# source generator that generates a decorator for a given interface and a given policy.
The policy must have methods taking only a Delegate as their respective argument.
For each interface method there has to be a policy method accepting an parameter of a corresponding delegate type.
The corresponding delegate type is the parameterless version of the interface method.
Thus, the policy at most has to support 4 delegate types: all combinations of sync/async, void and returning.

```csharp
[GenericPolicyDecorator]
partial class GenericPolicyFooDecorator(IFoo inner) : IFoo
{
    partial void Decorate(Action doInner)
    {
        doInner();
    }

    partial T Decorate(Func<T> doInner)
    {
        return doInner();
    }

    partial Task DecorateAsync(Func<Task> doInner)
    {
        return doInner();
    }

    partial Task<T> DecorateAsync(Func<Task<T>> doInner)
    {
        return doInner();
    }
}

interface IFoo
{
    void DoStuff();
    void DoOtherStuff(int arg1);
    Task DoStuffAsync();
    string GetStuff();
    Task<string> GetStuffAsync();
}

interface IGenericPolicy
{
    void Apply(Action do);
    T Apply<T>(Func<T> do);
    Task ApplyAsync(Func<Task> do);
    Task<T> ApplyAsync<T>(Func<Task<T>> do);
}

// <auto-generated />
partial class GenericPolicyFooDecorator
{
    void IFoo.DoStuff() => Decorate(() => inner.DoStuff());

    void IFoo.DoOtherStuff(int arg1) => Decorate(() => inner.DoOtherStuff(arg1));

    Task IFoo.DoStuffAsync() => DecorateAsync(() => inner.DoStuffAsync());

    string IFoo.GetStuff() => Decorate(() => inner.GetStuff());

    Task<string> IFoo.GetStuffAsync() => DecorateAsync(() => inner.GetStuffAsync())
}
```
