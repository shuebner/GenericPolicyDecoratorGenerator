# Generic Policy Decorator Generator

A C# source generator that generates a decorator for a given interface and a given policy.
The policy must have methods taking only a Delegate as their respective argument.
For each interface method there has to be a policy method accepting an parameter of a corresponding delegate type.
The corresponding delegate type is the parameterless version of the interface method.
Thus, the policy at most has to support 4 delegate types: all combinations of sync/async, void and returning.

```csharp
[GenericPolicyDecorator]
partial class GenericPolicyFooDecorator : IFoo;

interface IFoo
{
    void DoStuff();
    Task DoStuffAsync();
    string GetStuff();
    Task<string> GetStuffAsync();
}

interface IGenericPolicy
{
    void Apply(Action do);
    T Apply<T>(Func<T> do);
    Task ApplyAsync(Func<Task> do);
    Task<T> ApplyAsync<T>(Func<Task<T>> do);
}

// <auto-generated />
partial class GenericPolicyFooDecorator(
    IFoo inner,
    IGenericPolicy policy
)
{
    void IFoo.DoStuff()
    {
        policy.Apply(() => inner.DoStuff());
    }

    Task IFoo.DoStuffAsync()
    {
        policy.ApplyAsync(() => inner.DoStuffAsync());
    }

    string GetStuff()
    {
        return policy.GetStuff(() => inner.GetStuff());
    }

    Task<string> GetStuffAsync()
    {
        return policy.GetStuffAsync() => inner.GetStuffAsync());
    }
}

```
